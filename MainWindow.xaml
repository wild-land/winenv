<Window x:Class="WinEnv.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:WinEnv.ViewModels"
        Title="çŽ¯å¢ƒå˜é‡ç®¡ç†å™¨" 
        Height="700" Width="1000"
        MinHeight="500" MinWidth="700"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
    </Window.Resources>

    <Border CornerRadius="12" Background="{StaticResource BackgroundBrush}">
        <Grid>
            <!-- æ¯›çŽ»ç’ƒèƒŒæ™¯æ•ˆæžœ -->
            <Border CornerRadius="12">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#15FFFFFF" Offset="0"/>
                        <GradientStop Color="#08FFFFFF" Offset="0.5"/>
                        <GradientStop Color="#15FFFFFF" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
            </Border>

            <Grid Margin="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="48"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- æ ‡é¢˜æ  -->
                <Border Grid.Row="0" 
                        Background="#10FFFFFF" 
                        CornerRadius="12,12,0,0"
                        MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- æ ‡é¢˜ -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="16,0">
                            <Image Source="/app_icon.png" Width="24" Height="24" VerticalAlignment="Center" Margin="0,0,10,0" RenderOptions.BitmapScalingMode="HighQuality"/>
                            <TextBlock Text="çŽ¯å¢ƒå˜é‡ç®¡ç†å™¨" 
                                       Foreground="{StaticResource TextPrimaryBrush}" 
                                       FontSize="15" 
                                       FontWeight="SemiBold"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- çª—å£æŽ§åˆ¶æŒ‰é’® -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,8,0">
                            <Button x:Name="MinimizeButton" Content="â€”" 
                                    Width="40" Height="32"
                                    FontSize="12"
                                    Click="MinimizeButton_Click"
                                    Cursor="Hand">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#30FFFFFF"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <Button x:Name="MaximizeButton" Content="â˜" 
                                    Width="40" Height="32"
                                    FontSize="14"
                                    Click="MaximizeButton_Click"
                                    Cursor="Hand">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#30FFFFFF"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <Button x:Name="CloseButton" Content="âœ•" 
                                    Width="40" Height="32"
                                    FontSize="12"
                                    Click="CloseButton_Click"
                                    Cursor="Hand">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#50EF4444"/>
                                                            <Setter Property="Foreground" Value="White"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- ä¸»å†…å®¹åŒºåŸŸ -->
                <Grid Grid.Row="1" Margin="24">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- åˆ‡æ¢æ ‡ç­¾ (ä»…ç®¡ç†å‘˜æ¨¡å¼æ˜¾ç¤º) -->
                    <Border Grid.Row="0" Margin="0,0,0,16"
                            Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVisibility}}">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸ‘¤ ç”¨æˆ·å˜é‡" 
                                    Command="{Binding SwitchToUserCommand}"
                                    Padding="16,10"
                                    FontSize="14"
                                    Cursor="Hand"
                                    BorderThickness="0">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" 
                                                            CornerRadius="8" Padding="{TemplateBinding Padding}"
                                                            BorderThickness="0,0,0,2" BorderBrush="Transparent">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#15FFFFFF"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsUserMode}" Value="True">
                                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="#20FFFFFF" CornerRadius="8" Padding="{TemplateBinding Padding}"
                                                                    BorderThickness="0,0,0,2" BorderBrush="{StaticResource PrimaryBrush}">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <Button Content="ðŸ’» ç³»ç»Ÿå˜é‡" 
                                    Command="{Binding SwitchToSystemCommand}"
                                    Padding="16,10"
                                    FontSize="14"
                                    Cursor="Hand"
                                    Margin="8,0,0,0"
                                    BorderThickness="0">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" 
                                                            CornerRadius="8" Padding="{TemplateBinding Padding}"
                                                            BorderThickness="0,0,0,2" BorderBrush="Transparent">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#15FFFFFF"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsSystemMode}" Value="True">
                                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="#20FFFFFF" CornerRadius="8" Padding="{TemplateBinding Padding}"
                                                                    BorderThickness="0,0,0,2" BorderBrush="{StaticResource PrimaryBrush}">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                    </Border>

                    <!-- å·¥å…·æ  -->
                    <Grid Grid.Row="1" Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- æœç´¢æ¡† -->
                        <Border Grid.Column="0" 
                                Background="#1A1F2E" 
                                BorderBrush="#3D4663"
                                BorderThickness="1"
                                CornerRadius="10" 
                                MaxWidth="400"
                                HorizontalAlignment="Left">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" 
                                           Text="ðŸ”" 
                                           VerticalAlignment="Center" 
                                           Margin="14,0,10,0"
                                           FontSize="14"
                                           Foreground="#A8B4C4"/>
                                <TextBox Grid.Column="1" 
                                         Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                         Background="Transparent"
                                         BorderThickness="0"
                                         Foreground="{StaticResource TextPrimaryBrush}"
                                         CaretBrush="{StaticResource TextPrimaryBrush}"
                                         VerticalAlignment="Center"
                                         Padding="0,12,14,12"
                                         FontSize="14"
                                         Width="300">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="TextBox">
                                                        <Grid>
                                                            <ScrollViewer x:Name="PART_ContentHost"/>
                                                            <TextBlock Text="æœç´¢çŽ¯å¢ƒå˜é‡..." 
                                                                       Foreground="#6B7280"
                                                                       VerticalAlignment="Center"
                                                                       IsHitTestVisible="False"
                                                                       Visibility="{Binding Text.IsEmpty, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BoolToVisibility}}"/>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </Grid>
                        </Border>

                        <!-- æ“ä½œæŒ‰é’® -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Button Content="ðŸ”„ åˆ·æ–°" 
                                    Command="{Binding RefreshCommand}"
                                    Style="{StaticResource SecondaryButton}"
                                    Margin="0,0,12,0"/>
                            <Button Content="âž• æ·»åŠ " 
                                    Command="{Binding AddCommand}"
                                    Style="{StaticResource ModernButton}"
                                    Margin="0,0,12,0"/>
                            <Button Content="âœï¸ ç¼–è¾‘" 
                                    Command="{Binding EditCommand}"
                                    Style="{StaticResource SecondaryButton}"
                                    Margin="0,0,12,0"/>
                            <Button Content="ðŸ—‘ï¸ åˆ é™¤" 
                                    Command="{Binding DeleteCommand}"
                                    Style="{StaticResource DangerButton}"/>
                        </StackPanel>
                    </Grid>

                    <!-- æ•°æ®è¡¨æ ¼ -->
                    <Border Grid.Row="2" 
                            Background="#10FFFFFF" 
                            CornerRadius="12"
                            Padding="8">
                        <DataGrid ItemsSource="{Binding FilteredVariables}"
                                  SelectedItem="{Binding SelectedVariable}"
                                  Style="{StaticResource ModernDataGrid}"
                                  IsReadOnly="True"
                                  MouseDoubleClick="DataGrid_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="åç§°" 
                                                    Binding="{Binding Name}" 
                                                    Width="250">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="Foreground" Value="#60DDDD"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=DataGridRow}}" Value="True">
                                                    <Setter Property="Foreground" Value="#A0FFFF"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="å€¼" 
                                                    Binding="{Binding Value}" 
                                                    Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>

                <!-- ç¼–è¾‘å¯¹è¯æ¡†é®ç½©å±‚ -->
                <Grid Grid.Row="0" Grid.RowSpan="2" 
                      Visibility="{Binding IsEditing, Converter={StaticResource BoolToVisibility}}">
                    <!-- åŠé€æ˜ŽèƒŒæ™¯ -->
                    <Border Background="#80000000" CornerRadius="12" MouseLeftButtonDown="Overlay_MouseLeftButtonDown"/>
                    
                    <!-- å¯¹è¯æ¡† -->
                    <Border Background="{StaticResource SurfaceBrush}" 
                            CornerRadius="16" 
                            Width="500"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Padding="32">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="40" ShadowDepth="0" Opacity="0.5"/>
                        </Border.Effect>
                        
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- å¯¹è¯æ¡†æ ‡é¢˜ -->
                            <TextBlock Grid.Row="0" 
                                       Text="{Binding EditDialogTitle}" 
                                       FontSize="20" 
                                       FontWeight="Bold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Margin="0,0,0,24"/>

                            <!-- åç§°è¾“å…¥ -->
                            <StackPanel Grid.Row="1" Margin="0,0,0,16">
                                <TextBlock Text="å˜é‡åç§°" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           FontSize="13"
                                           Margin="0,0,0,8"/>
                                <TextBox x:Name="NameTextBox"
                                         Text="{Binding EditingVariable.Name, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource ModernTextBox}"/>
                            </StackPanel>

                            <!-- å€¼è¾“å…¥ - å•å€¼æ¨¡å¼ -->
                            <StackPanel Grid.Row="2" Margin="0,0,0,24"
                                        Visibility="{Binding IsSingleValue, Converter={StaticResource BoolToVisibility}}">
                                <TextBlock Text="å˜é‡å€¼" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           FontSize="13"
                                           Margin="0,0,0,8"/>
                                <TextBox Text="{Binding EditingVariable.Value, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource ModernTextBox}"
                                         TextWrapping="Wrap"
                                         AcceptsReturn="True"
                                         Height="100"
                                         VerticalContentAlignment="Top"/>
                            </StackPanel>
                            
                            <!-- å€¼è¾“å…¥ - å¤šå€¼æ¨¡å¼ï¼ˆè·¯å¾„åˆ—è¡¨ï¼‰ -->
                            <StackPanel Grid.Row="2" Margin="0,0,0,24"
                                        Visibility="{Binding IsMultiValue, Converter={StaticResource BoolToVisibility}}">
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="è·¯å¾„åˆ—è¡¨ (å¤šä¸ªå€¼ä»¥åˆ†å·åˆ†éš”)" 
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               FontSize="13"
                                               VerticalAlignment="Center"/>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                        <Button Content="+" 
                                                Command="{Binding AddPathItemCommand}"
                                                Width="32" Height="32"
                                                Padding="0"
                                                Background="#306366F1"
                                                Foreground="{StaticResource TextPrimaryBrush}"
                                                BorderThickness="0"
                                                FontSize="18"
                                                FontWeight="Bold"
                                                ToolTip="æ·»åŠ è·¯å¾„"
                                                Cursor="Hand">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#506366F1"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <Button Content="âˆ’" 
                                                Command="{Binding RemovePathItemCommand}"
                                                Width="32" Height="32"
                                                Padding="0"
                                                Background="#30EF4444"
                                                Foreground="{StaticResource TextPrimaryBrush}"
                                                BorderThickness="0"
                                                FontSize="18"
                                                FontWeight="Bold"
                                                ToolTip="åˆ é™¤é€‰ä¸­è·¯å¾„"
                                                Margin="6,0,0,0"
                                                Cursor="Hand">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#50EF4444"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <Button Content="â–²" 
                                                Command="{Binding MovePathItemUpCommand}"
                                                Width="32" Height="32"
                                                Padding="0"
                                                Background="#30FFFFFF"
                                                Foreground="{StaticResource TextPrimaryBrush}"
                                                BorderThickness="0"
                                                FontSize="12"
                                                ToolTip="ä¸Šç§»"
                                                Margin="6,0,0,0"
                                                Cursor="Hand">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#50FFFFFF"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <Button Content="â–¼" 
                                                Command="{Binding MovePathItemDownCommand}"
                                                Width="32" Height="32"
                                                Padding="0"
                                                Background="#30FFFFFF"
                                                Foreground="{StaticResource TextPrimaryBrush}"
                                                BorderThickness="0"
                                                FontSize="12"
                                                ToolTip="ä¸‹ç§»"
                                                Margin="6,0,0,0"
                                                Cursor="Hand">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#50FFFFFF"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                                <Border Background="#15FFFFFF" CornerRadius="8" MaxHeight="200">
                                    <ListBox ItemsSource="{Binding PathItems}"
                                             SelectedItem="{Binding SelectedPathItem}"
                                             Background="Transparent"
                                             BorderThickness="0"
                                             Padding="4">
                                        <ListBox.ItemContainerStyle>
                                            <Style TargetType="ListBoxItem">
                                                <Setter Property="Padding" Value="0"/>
                                                <Setter Property="Margin" Value="0,2"/>
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="ListBoxItem">
                                                            <Border x:Name="border" 
                                                                    Background="#10FFFFFF" 
                                                                    CornerRadius="6"
                                                                    BorderThickness="2"
                                                                    BorderBrush="Transparent"
                                                                    Padding="8,6">
                                                                <ContentPresenter/>
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsSelected" Value="True">
                                                                    <Setter TargetName="border" Property="Background" Value="#306366F1"/>
                                                                    <Setter TargetName="border" Property="BorderBrush" Value="#6366F1"/>
                                                                </Trigger>
                                                                <MultiTrigger>
                                                                    <MultiTrigger.Conditions>
                                                                        <Condition Property="IsMouseOver" Value="True"/>
                                                                        <Condition Property="IsSelected" Value="False"/>
                                                                    </MultiTrigger.Conditions>
                                                                    <Setter TargetName="border" Property="Background" Value="#20FFFFFF"/>
                                                                </MultiTrigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </ListBox.ItemContainerStyle>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Background="Transparent">
                                                    <TextBox Text="{Binding Path, UpdateSourceTrigger=PropertyChanged}"
                                                             Background="Transparent"
                                                             BorderThickness="0"
                                                             Foreground="{StaticResource TextPrimaryBrush}"
                                                             CaretBrush="{StaticResource TextPrimaryBrush}"
                                                             FontSize="13"
                                                             Padding="4"
                                                             GotFocus="PathTextBox_GotFocus"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Border>
                            </StackPanel>

                            <!-- æŒ‰é’® -->
                            <StackPanel Grid.Row="3" 
                                        Orientation="Horizontal" 
                                        HorizontalAlignment="Right">
                                <Button Content="å–æ¶ˆ" 
                                        Style="{StaticResource SecondaryButton}"
                                        Click="CancelButton_Click"
                                        Margin="0,0,12,0"/>
                                <Button Content="ä¿å­˜" 
                                        Style="{StaticResource ModernButton}"
                                        Command="{Binding SaveCommand}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>
